---
title: ğŸ¥œ [Node.js] Node.js ë¥¼ ì‚¬ìš©í•œ Server êµ¬í˜„
date: 2023-09-08 20:30:00 +0800
categories: [Backend, Node.js]
tags: [Backend, Node.js, JavaScript]
---

> Server êµ¬í˜„ ì‹œì˜ ê¸°ë³¸ ì„¤ì •ê³¼ ì„œë²„ êµ¬í˜„ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ëŠ” í¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.
{: .prompt-tip}

## CJS

> **CJS** ë€?
>
> `Common JS` ì˜ ì•½ìë¡œ ìˆœìˆ˜ JavaScript ë§Œì„ ì‚¬ìš©í•œ ì„œë²„ êµ¬í˜„ì„ ëœ»í•¨

1. íŒŒì¼ ë‹¨ìœ„ë¡œ ìº¡ìŠí™”
2. `require` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ `module(package)` ë¥¼ ë¶ˆëŸ¬ì˜´
3. `module.exports` ë‚˜ `exports` ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“ˆì˜ í•¨ìˆ˜ë‚˜ ê°ì²´ë¥¼ ì™¸ë¶€ì— ê³µê°œí•¨ 

```javascript
const http = require('http');

const server = http.createServer((req, res) => {
  res.writeHead(200, { "Content-Type": "text/plain" });
  res.write("Hello Node.js! CJS!");
  res.end();
});

server.listen(3000, () => {
  console.log("Server is listening on port 3000 ...");
});
```


## ESM

> `ECMAScript Module` ì˜ ì•½ìë¡œ JavaScript ì˜ ê³µì‹ ëª¨ë“ˆ ì‹œìŠ¤í…œ

1. `import` ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ëª¨ë“ˆì´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜´
2. `export` ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë“ˆì˜ í•¨ìˆ˜, í´ë˜ìŠ¤, ë³€ìˆ˜ ë“±ì„ ì™¸ë¶€ì— ê³µê°œ
3. `ESM` ì€ ëª¨ë“ˆ ë¡œë”©ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ
4. ì½”ë“œì˜ êµ¬ì¡°ë¥¼ ë” ëª…í™•í•˜ê²Œ í•˜ê³ , ëª¨ë“ˆ ê°„ì˜ ì˜ì¡´ì„± ê´€ë¦¬ë¥¼ ìš©ì´

```json
{
    "name": "my-app",
    "version": "1.0.0",
    "description": "test node.js folder",
    "main": "index.js",
    "type": "module"
    
    // ì¤‘ëµ...
}
```
> ì‚¬ìš©í•˜ê¸° ìœ„í•´ `type` ì„ `module` ë¡œ ê±¸ì–´ì£¼ì–´ì•¼ í•œë‹¤.


```javascript
import { createServer } from "http";
// ë‚´ê°€ ì›í•˜ëŠ” ëª¨ë“ˆì„ ì‚¬ìš©í•œë‹¤. import ë¬¸ê³¼ ë™ì¼

const server = createServer((req, res) => {
  res.writeHead(200, { "Content-Type": "text/plain" });
  res.write("Hello Node.js! ESM!");
  // í•­ìƒ response ë¥¼ ì‚¬ìš©í•´ ì‘ë‹µí•  ë•ŒëŠ”
  res.end();
  // ì‘ë‹µì„ ëë‚´ì£¼ì–´ì•¼ í•œë‹¤!
});

server.listen(3000, () => {
  console.log("Server is listening port 3000 ...");
});
```

<br/>
<hr/>

## Nodemon

> `Node.js` ì„œë²„ë¥¼ í‚¬ ë•Œ, ì½”ë“œ ë³€ê²½ì´ ì¦‰ê° ë°˜ì˜ë˜ì§€ ì•ŠëŠ”ë‹¤.
> 
> ì¦‰ê° ë°˜ì˜ë˜ê²Œ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

``` terminal
npm install nodemon -D
```

<br/>
<hr/>

## Express ë€?

> `Express`ëŠ” `Node.js`ì˜ í•µì‹¬ ëª¨ë“ˆì¸ `HTTP`ë¥¼ ì¶”ìƒí™”í•˜ì—¬ ë¼ìš°íŒ…, ìš”ì²­ ì²˜ë¦¬, ì˜¤ë¥˜ ê´€ë¦¬ ë“±
>
> ê¸°ëŠ¥ì„ ê°„ê²°í•˜ê³  íš¨ìœ¨ì ì¸ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
>
> ì¦‰, `Express` ëŠ” ì—¬ëŸ¬ `middleware`ì˜ ì—°ê²°


```javascript
import express from 'express';

const app = express();
const port = 3000;

// ë£¨íŠ¸ ê²½ë¡œì— ëŒ€í•œ GET ìš”ì²­ ì²˜ë¦¬
app.get('/', (req, res) => {
  res.send('Hello World!');
});

// ì„œë²„ ì‹œì‘
app.listen(port, () => {
  console.log(`Example app listening at http://localhost:${port}`);
});
```

<hr/>
<br/>

## FS

>  `File System`ì„ ì˜ë¯¸í•˜ë©°, íŒŒì¼ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ì—¬
>
> íŒŒì¼ì„ ìƒì„±, ì½ê¸°, ì“°ê¸°, ì‚­ì œ ë° ìˆ˜ì • ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” APIë¥¼ ì œê³µ

<hr/>
<br/>

## Template Engine

> í˜ì´ì§€ë¥¼ ë§Œë“¤ ë•Œë§ˆë‹¤ Rendering í•  html íŒŒì¼ì„ ê³„ì†í•´ì„œ ìƒì„±í•  ìˆ˜ ì—†ë‹¤.
>
> ë”°ë¼ì„œ `Template` í™” í•˜ì—¬ ì‚¬ìš©í•´ì•¼ Code ì¬ì‚¬ìš©ì„±ë„ ë†’ì•„ì§€ë©° ê°€ë…ì„±ë„ ì¢‹ì•„ì§„ë‹¤.
>
> ì´ëŸ¬í•œ ë™ì‘ì„ ë„ì™€ì£¼ëŠ” ê²ƒì´ `Template Engine` ì´ë‹¤.
>
> `Mustache` , `Pug` , `Nunjucks` ê°€ ëŒ€í‘œì ì´ë©° ì—°ìŠµì—ì„œëŠ” `Nunjucks` ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

<hr/>
<br/>

## Server ë™ì‘ ê¸°ì´ˆ ì˜ˆì‹œ

![image-01](../assets/img/2023-09-08/image-01.png){: .w-50 .align-center}
_(file directory)_

```javascript
import express from "express";
import nunjucks from "nunjucks";
import bodyParser from "body-parser";
import fs from "fs";
import path from "path";

const app = express();
const __dirname = path.resolve();

// file path
// my-app/data/writing.json ìœ¼ë¡œ ê²½ë¡œ ì§€ì •
const filePath = path.join(__dirname, "data", "writing.json");

// body parser set
app.use(bodyParser.urlencoded({ extended: false })); // express ê¸°ë³¸ ëª¨ë“ˆ ì‚¬ìš©
app.use(bodyParser.json());

// view engine set
app.set("view engine", "html"); // main.html -> main(.html)

// nunjucks
nunjucks.configure("views", { // views folder ë‚´ì— ìˆëŠ” ë³€ê²½ ê°’ì„ watch
  watch: true, // html íŒŒì¼ì´ ìˆ˜ì •ë  ê²½ìš°, ë‹¤ì‹œ ë°˜ì˜ í›„ ë Œë”ë§
  express: app,
});

// middleware
// main page GET
app.get("/", (req, res) => {
  const fileData = fs.readFileSync(filePath);
  const writings = JSON.parse(fileData);
  console.log(writings);

  res.render("main", { list: writings });
  // main.html ì˜ list ì— props ì „ë‹¬
  // list ëŠ” ì´ì œ nunjucks ì— ì˜í•´ ê°’ì„ í™œìš© ê°€ëŠ¥
});

app.get("/write", (req, res) => {
  res.render("write");
});

app.post("/write", async (req, res) => {
  const title = req.body.title;
  const contents = req.body.contents;
  const date = req.body.date;

  // data ì €ì¥
  // data/wriring.json ì— ê°’ ì €ì¥

  const fileData = fs.readFileSync(filePath);
  console.log(fileData); // íŒŒì¼ ì½ê¸°

  const writings = JSON.parse(fileData);
  console.log(writings); // íŒŒì¼ ë³€í™˜

  // request ë°ì´í„° ì €ì¥
  writings.push({
    title: title,
    contents: contents,
    date: date,
  });

  // data/writing.json ì— ì €ì¥í•˜ê¸°
  fs.writeFileSync(filePath, JSON.stringify(writings));

  res.render("detail", {
    detail: { title: title, contents: contents, date: date },
  });
});

app.get("/detail", async (req, res) => {
  res.render("detail");
});
app.listen(3000, () => {
  console.log(`
  â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—        â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•        â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—          â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆ   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
  â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
  â•šâ•â•  â•šâ•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â• â•šâ•â•â•â•â•â•â•
                                                        
  `);
});

```

![image-02](../assets/img/2023-09-08/image-02.png){: .w-50 .align-center}
![image-03](../assets/img/2023-09-08/image-03.png){: .w-50 .align-center}
![image-04](../assets/img/2023-09-08/image-04.png){: .w-50 .align-center}

```json
[
  { "title": "HELLO", "contents": "123", "date": "" },
  { "title": "ê¸€ ì‘ì„±", "contents": "ì‘ì„±ì¤‘...", "date": "2024-02-28" }
]
```
_(ì •ìƒì ìœ¼ë¡œ json ì— data ê°€ ë“¤ì–´ê°„ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ)_